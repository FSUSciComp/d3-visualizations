<!DOCTYPE html>
<meta charset="utf-8">
<head>
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <script src="https://d3js.org/d3.v4.min.js"></script>
<!-- Copyright (c) 2010-2017 The MathJax Consortium -->
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Include these scripts for MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]}
  });
</script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML'></script>
<!-- End of scripts necessary for MathJax -->

</head>
<style>
  div {
    overflow: scroll;
  }
  body { margin:0;top:0;right:0;bottom:0;left:0;}

  #left {
    float: left;
    width: 50%;
    text-align: right;
  }

  #right {
    float: right;
    width: 50%;
    text-align:left;
  }

  .dot {
    fill: steelblue;
  }

  .ticks{
    font: 10px sans-serif;
  }

  .track,
  .track-inset,
  .track-overlay{
    stroke-linecap: round;
  }

  .track{
    stroke: #000;
    stroke-opacity: 0.2;
    stroke-width: 10px;
  }
  
  .track-inset{
    stroke: #ddd;
    stroke-width: 8px;
  }

  .track-overlay{
    pointer-events: stroke;
    stroke-width: 50px;
    stroke: transparent;
    cursor: crosshair;
  }

  .handle{
    fill: #fff;
    stroke: #000;
    stroke-opacity: 0.5;
    stroke-width: 1.25px;
  }

  .point{
    r: 7px;

  }
  .pointR{
    r: 4px;

  }

</style>

<body>

<h1> The Heat Equation </h1>
<p>
In this example we will be solving a parabolic PDE, the heat equation, in 1D:
$$\frac{\partial U}{\partial t}=\alpha\frac{\partial^{2}U}{\partial
x^{2}},$$where $\alpha$ is the thermal diffusivity coefficient. An example of where this would be used would be to determine
how the temperature $U(x,t)$ within a material changed with time.  For
this example we will imagine that the ends of the material are being
cooled to keep them at some fixed
temperature.  In this case we will unrealistically cool the endpoints to
zero.  This gives us the boundary conditions
$U(\frac{-L}{2},t)=U(\frac{L}{2},t)=0$. The temperature profile that we
will begin with is a gaussian. The gaussian is the the steady state
solution
that results from
heating the center of the material, holding it at some constant temperature
$T$. For this example $T(0,0)=1$. 
</p>
<p>
$\textbf{Choosing a Numerical Scheme}$
</p>
<p>
We'll choose two numerical schemes to explore in solving this PDE. First, we
need to decide on how we are going to estimate the second spacial
derivative of $U.$ For this problem I'm choosing $2^{nd}$ order central
difference:
$$\frac{\partial^{2}U}{\partial{x^{2}}}_{i}\approx\frac{U_{i-1}-2U_{i}+U_{i+1}}{\Delta
x^{2}}.$$
Now we need to decide how to step forward in time. An obvious choice
for this is simple Forward Euler: $$U(x,t+\Delta t)\approx
U(x,t)+\dot{U}(x,t)\Delta t$$
where $\dot{U}$ is the first time derivative of $U$ which we have an
expression for from the PDE that we aim to satisfy. Plugging in our
approximation for the second derivative we can see the iterative scheme
takes shape:
$$U_{x_{i},t+1}=U_{x_{i},t}+\alpha \left(\frac{U_{x_{i-1},t}-2U_{x_{i},t}+U_{x_{i+1},t}}{\Delta
x^{2}}\right)\Delta t.$$ 
It's clear to see that the LHS is calculated only from $U$ from the
previous timestep. This means we can simply step forward through time
if we always save what $U$ was from the last step and iterate over it.
Thinking about the fact that we are stepping forward with every step
gives us a simple approach to investigate stability. If we write out the
first two iterations of FE it should be clear what conditions need to be
satisfied for stability.
For the first iteration we have:
$$U_{1}^{i}=U_{0}^{i}+\alpha\left(\frac{U_{0}^{i-1}-2U_{0}^{i}+U_{0}^{i+1}}{\Delta
x^{2}}\right)\Delta t=\left(1-\frac{2\alpha\Delta t}{\Delta
x^{2}}\right)U_{0}^{i}+\frac{\alpha\Delta t}{\Delta
x^{2}}(U_{0}^{i-1}+U_{0}^{i+1}),$$
taking another step we can see that the solution at any point in time
will be dependent on the initial condition
$$U_{2}^{i}=\left(1-\frac{2\alpha\Delta t}{\Delta
x^{2}}\right)U_{1}^{i}+\frac{\alpha\Delta t}{\Delta
x^{2}}(U_{1}^{i-1}+U_{1}^{i+1})\approx\left(1-\frac{2\alpha\Delta
t}{\Delta x^{2}}\right)^{2}U_{0}^{i}.$$
This leads us to an expression for the leading term of the solution at
the $n^{th}$ timestep:
$$U_{n}^{i}\approx\left(1-\frac{2\alpha\Delta t}{\Delta
x^{2}}\right)^{n}U_{0}^{i}.$$
It's clear to see that if $\left|\left(1-\frac{2\alpha\Delta t}{\Delta
x^{2}}\right)^{n}\right|>1$ our solution will
grow exponentially. Since $\Delta t$ and $\alpha$ will always be
positive our stability condition is$$\frac{\alpha\Delta t}{\Delta
x^{2}}\leq1.$$ 
</p>
<p>

</p>
<script type='text/javascript' src='d3FeBeSVG.js'></script>

<line x1="0" y1="0" x2="200" y2="200" style="stroke:rgb(255,0,0);stroke-width:2" />
<!--<script type='text/javascript' src='d3HeatEqnRK2.js'></script>-->
</body>
